<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ConsumptionReport" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="c3b6d2c5-596e-4459-9b3e-0f3001f089d2">
	<property name="ireport.zoom" value="1.6105100000000014"/>
	<property name="ireport.x" value="261"/>
	<property name="ireport.y" value="0"/>

	<parameter name="REPORT_SUBTITLE" class="java.lang.String"/>
	<parameter name="KEPALA_SEKOLAH_NAME" class="java.lang.String"/>
	<parameter name="KEPALA_SEKOLAH_NIP" class="java.lang.String"/>

	<queryString language="SQL">
		<![CDATA[SELECT
                a.*,
                c.`name` AS `name`,
                d.`name` AS room_name,
                e.`name` AS user_name,
        CASE
                        b.`status` 
                        WHEN 0 THEN
                        b.started_at 
                        WHEN 1 THEN
                        b.checked_in_at 
                        WHEN 2 THEN
                        b.checked_out_at ELSE b.updated_at 
                END AS `start_date`,
        CASE
                        b.`status` 
                        WHEN 0 THEN
                        b.ended_at ELSE NULL 
                END AS `end_date`,
        CASE
                        b.`status` 
                        WHEN 0 THEN
                        'Dipesan' 
                        WHEN 1 THEN
                        'Check In' 
                        WHEN 2 THEN
                        'Check Out' ELSE 'Dibatalkan' 
                END AS `status` 
        FROM
                `consumption_reservation` a
                JOIN reservations b ON a.reservation_id = b.id
                JOIN consumptions c ON a.consumption_id = c.id
                JOIN rooms d ON b.room_id = d.id 
                LEFT JOIN users e ON e.id = b.user_id
        ORDER BY
                start_date DESC]]>
	</queryString>
	<field name="name" class="java.lang.String"/>
	<field name="qty" class="java.lang.Integer"/>
	<field name="room_name" class="java.lang.String"/>
	<field name="user_name" class="java.lang.String"/>
	<field name="status" class="java.lang.String"/>
	<field name="start_date" class="java.sql.Timestamp"/>
	<field name="end_date" class="java.sql.Timestamp"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="44" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="802" height="23" uuid="325e913e-fcd9-4cbd-b1d3-063a7215e751"/>
				<textElement>
					<font size="18" isBold="true"/>
				</textElement>
				<text><![CDATA[Lap. Konsumsi]]></text>
			</staticText>
			<textField>
				<reportElement x="0" y="23" width="802" height="20" uuid="c4293a64-9ca9-4cb3-b4de-1399a9862317"/>
				<textElement>
					<font size="13"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{REPORT_SUBTITLE}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<columnHeader>
		<band height="23">
			<staticText>
				<reportElement mode="Opaque" x="0" y="3" width="802" height="15" backcolor="#70A9A9" uuid="a6fac4af-c96a-451b-b6ab-a4c19b2bd3be"/>
				<box>
					<bottomPen lineWidth="1.0" lineColor="#CCCCCC"/>
				</box>
				<text><![CDATA[ ]]></text>
			</staticText>
			<staticText>
				<reportElement x="162" y="3" width="65" height="15" uuid="b6f0ba77-b506-41e7-a7f6-71d23f4febba"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Jumlah]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="3" width="162" height="15" uuid="6b47a847-e6f9-4235-a48f-79eb513d7413"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Konsumsi]]></text>
			</staticText>
			<staticText>
				<reportElement x="227" y="3" width="121" height="15" uuid="4ac16c99-fba6-4050-8376-e8501e083631"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Gedung/Ruangan]]></text>
			</staticText>
			<staticText>
				<reportElement x="348" y="3" width="277" height="15" uuid="c71f1f71-4cf5-4134-976b-5db78dbe4dd7"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Tanggal]]></text>
			</staticText>
			<staticText>
				<reportElement x="703" y="3" width="99" height="15" uuid="a7b567cd-e7cb-436a-938e-c206c39a3496"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Dibuat oleh]]></text>
			</staticText>
			<staticText>
				<reportElement x="625" y="3" width="78" height="15" uuid="5ae6b1cd-371e-4e30-82d2-13fc825b7c67"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Status]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="16">
			<staticText>
				<reportElement mode="Opaque" x="0" y="0" width="802" height="14" backcolor="#E5ECF9" uuid="4fa4cd86-21b5-4a3d-945a-bbe886b91f60"/>
				<box>
					<bottomPen lineWidth="0.25" lineColor="#CCCCCC"/>
				</box>
				<text><![CDATA[ ]]></text>
			</staticText>
			<textField>
				<reportElement x="162" y="1" width="65" height="15" uuid="44647917-2295-4330-aca7-e5646b7f6556"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{qty}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="0" y="0" width="162" height="15" uuid="2089b987-bf22-4fc7-a895-0fa2df00963c"/>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="703" y="1" width="99" height="15" uuid="6cf0b05b-f8bf-4d7c-96de-add0a7aa91e2"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{user_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="227" y="1" width="121" height="15" uuid="acca8dd1-6e2e-4a6c-a07c-341217adf488"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{room_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="348" y="1" width="140" height="15" uuid="3790a193-aa6b-4d72-b580-96e1015806a9"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{start_date}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="488" y="1" width="137" height="15" uuid="64a19c83-ebed-42e7-b397-0eb4ab3583db"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{end_date}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="625" y="0" width="78" height="15" uuid="7227fa2f-9963-465d-8c63-1d5759209598"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="9"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{status}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band height="5" splitType="Stretch">
			<line>
				<reportElement positionType="FixRelativeToBottom" x="0" y="3" width="802" height="1" uuid="5daf4759-9d18-415f-ae1e-a483cb291c5e"/>
				<graphicElement>
					<pen lineWidth="0.5" lineColor="#999999"/>
				</graphicElement>
			</line>
		</band>
	</columnFooter>
	<pageFooter>
		<band height="25" splitType="Stretch">
			<frame>
				<reportElement mode="Opaque" x="0" y="3" width="802" height="15" backcolor="#70A9A9" uuid="cffb0e1e-bea7-4f59-af72-f39a5f74d5bd"/>
				<textField evaluationTime="Report">
					<reportElement x="757" y="0" width="40" height="15" uuid="376802a6-db6a-4714-99ca-8044f182e615"/>
					<textElement verticalAlignment="Middle">
						<font size="10" isBold="false"/>
					</textElement>
					<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="677" y="0" width="80" height="15" uuid="01caab6b-4bef-4a55-8dd7-8dbd8e1372b5"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="10" isBold="false"/>
					</textElement>
					<textFieldExpression><![CDATA["Hal "+$V{PAGE_NUMBER}+" of"]]></textFieldExpression>
				</textField>
				<textField pattern="EEEEE dd MMMMM yyyy">
					<reportElement x="15" y="0" width="197" height="15" uuid="33211f8a-c02a-4419-a3ea-c17bb9c5a9ce"/>
					<textElement verticalAlignment="Middle">
						<font size="10" isBold="false"/>
					</textElement>
					<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
				</textField>
			</frame>
		</band>
	</pageFooter>
	<lastPageFooter>
		<band height="150">
			<textField pattern="EEEEE dd MMMMM yyyy">
				<reportElement x="658" y="8" width="144" height="20" uuid="63ce6a54-98ba-411c-bce3-39b58ce509e3"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="15" y="110" width="147" height="16" uuid="0c9b2f6f-aeb0-4b72-8e96-384be80f666c"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="11" isBold="true" isUnderline="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{KEPALA_SEKOLAH_NAME}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="15" y="28" width="147" height="16" uuid="5bb464bc-b9dc-45c3-aa7c-25e7c3c61057"/>
				<textElement textAlignment="Center"/>
				<text><![CDATA[Mengetahui:]]></text>
			</staticText>
			<textField>
				<reportElement x="15" y="126" width="147" height="24" uuid="c8b2950e-dad1-4a40-8c86-e51336ee514d"/>
				<textElement textAlignment="Center"/>
				<textFieldExpression><![CDATA[$P{KEPALA_SEKOLAH_NIP}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="15" y="44" width="147" height="16" uuid="5d03af6f-d2d3-4ace-8aa5-2ef43aacf7ab"/>
				<textElement textAlignment="Center"/>
				<text><![CDATA[Kepala Sekolah]]></text>
			</staticText>
		</band>
	</lastPageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
</jasperReport>
